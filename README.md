INTRODUCTION 
 
1.1 Blood Cells and Their Classifications 
Haematopoietic cells or as they are most commonly referred to as blood cells, are cells which are produced through haematopoiesis and are mainly found in the blood. Blood is composed of the blood cells which account for up to 45% of the blood tissue by volume, with the remaining 55% of the volume being composed of plasma, the liquid component of the blood. Majorly blood cells can be classified into Red Blood Cells (erythrocytes), White Blood Cells (leukocytes) and Platelets (thrombocytes).  

1.1.1 Red Blood Cells 
Red Blood Cells or erythrocytes are the most abundant cells in the blood. Being much smaller than other human cells, they primarily carry oxygen and collect carbon dioxide through the use of haemoglobin. Red Blood Cells contains Haemoglobin (33%) which is an iron containing protein that gives red blood cells their colour and facilitate the transportation of oxygen throughout our body.The red blood cells have a biconcave disc shape which is round and flat, with the additional ability of being deformable which allow them to squeeze through narrow capillaries.  

1.1.2 White Blood Cells 
Accounting for only 1% of the blood, white blood cells or leukocytes are cells of the immune system which play an integral part in the defence mechanism of the body against both infectious diseases and foreign materials. They exist in all parts of the body, including the connective tissue, lymph system and the blood stream. White Blood Cells can be classified into Granulocytes (having visible granules or grains inside the cells) and non-granulocytes (which are free of visible grains under the microscope). Each category can be further divided into subcategories where basophils, eosinophils and mast cells belong to the former whereas lymphocytes and monocytes to the latter. 

1.1.3 Platelets 
Platelets or thrombocytes are very small, irregularly shaped clear cell fragments. With their nucleus being absent, they measure up to 3-4 micrometre in diameter and are derived from fragmentation of megakaryocytes. There can be 150,000 to 400,000 platelets in each micro meter and each platelet has an approximate lifespan of 5 to 9 days. Platelets are a natural source of growth factors which maintain lining of blood vessels and also play an important role in the formation of blood clots. 
  
1.1.4 	Malaria Parasite (Plasmodium Parasite) 
Malaria is a mosquito-borne infectious disease affecting humans and other animals caused by parasitic single-celled microorganisms belonging to the Plasmodium group. These Plasmodium group have a very complex life cycle. Fig 1.3 gives a descriptive explanation of the life cycle of Malaria Parasite. 
  
 
Human malaria is mainly caused by four different species of Plasmodium:  
1.	Plasmodium falciparum- which is responsible for the majority of malaria deaths globally and is the most prevalent species in sub-Saharan Africa. The remaining species are not typically as life threatening as Plasmodium falciparum. 
2.	Plasmodium vivax- which is the second most significant species and is prevalent in Southeast Asia and Latin America. Plasmodium vivax have the added complication of a dormant liver stage, which can be reactivated in the absence of a mosquito bite, leading to clinical symptoms. 
3.	Plasmodium ovale- is a species of parasitic protozoa that causes tertian malaria in humans. It is one of several species of Plasmodium parasites that infect humans including Plasmodium falciparum and Plasmodium vivax which are responsible for most malarial infection. It is rare compared to these two parasites, and substantially less dangerous than Plasmodium Falciparum. 
4.	Plasmodium malariae- is also called "benign malaria" and is not nearly as dangerous as that produced by Plasmodium Falciparum or Plasmodium vivax. It causes fevers that recur at approximately three-day intervals (also called as quartan fever), longer than the two-day intervals of the other malarial parasites, hence they are alternative named as quartan fever and quartan malaria. 
 
1.2 Need for Plasmodium Detection 
Malaria is an acute febrile illness with incubation period of 7 days or longer. Thus, a febrile illness developing more than 1 week after the first possible exposure is malaria. Malaria is actually considered as a potential medical emergency and should be treated accordingly. Delay in diagnosis and treatment is a leading cause of death in malaria patients globally. Malaria must be recognized promptly in order to treat the patient in time and to prevent further spread of infection in the community via local mosquitoes. Malaria can be diagnosed based on the patient’s travel history, symptoms, and the physical findings at examination. However, for a definitive diagnosis to be made, laboratory blood tests must demonstrate the presence of malarial parasites or their components. 
 
1.3 Neural Networks in Malaria Diagnosis 
In recent years many new and extremely efficient neural networks and techniques associated to them have been discovered. This in turn means a potential for change in all the existing sectors in which the neural networks can be implemented. In the malaria parasite detection scenario, the change comes with the introduction of Convolutional Neural Networks (CNN) and Region Proposal Network (RPN). These neural networks have been tried and tested in giving a very high level of accuracy and image classification and detection. By utilizing the advantages of these Neural networks, we can improve upon the hardware and overall computing software which is used in the detection of various classifications of Plasmodium. In our Minor project, we have tried to find new ways to better improve the accuracy and computational time required. 

1.4 Aim and Problem Statement 
With the constant advancements being made in the various fields of technology, the field of medicine does not lag too far behind with new medical diagnosis techniques being developed every day. Furthermore, there is a rise in the number of people requiring medical attention with the continuously increasing worldwide population numbers.  
Even though the technologies are improving, the number of doctors still remains a little bit scarce as compared to the number of patients. The main aim of this project is to cut down on the labour time required to be put down in the laboratories testing the blood samples and thus allow the doctors to be able to treat more patients in the same amount of time. With the use of cutting-edge methods and techniques we aim to collaborate to the betterment of the early detection of these five different types of Plasmodium parasite which in turn help the people suffering from a life-threatening disease like Malaria. 
1.5 Objective and Scope of Project 
The objective of this project is to provide a method which is efficient in detection of malaria parasite and reduce the overall time taken by the conventional methods. As explained above, the effect of different types of Plasmodium parasite on human body can be life threatening and it can be minor as well.  Through this project, we can help the doctors identify the stage at which a patient is currently suffering and also many a times can save the life of the patients whose treatment might be delayed by the time required by the laboratory to give the reports. 
The scope of the project follows a level-based topology with a bottom up approach. We will begin by using two very widely used neural networks – Convolutional Neural Network (CNN) and Region Proposal Network (RPN). Firstly, we will compute the outputs from the convolutional neural network which will create all possible images from the input image. CNN will have pre-trained weights according to ImageNet datasets and the RPN will keep selecting the images which contain the malaria parasite and give the outputs accordingly. Additionally, we will try to test and implement the addition of other different neural networks like we have used the pre-trained Inception v2 as a third layer which can help improve the accuracy and better classify the results. 
 
 

BACKGROUND STUDY 
 
2.1 Learning about Neural Networks 
The first and most foremost step in our background study was to learn about the neural networks themselves and learn about the various techniques and steps used to implement them and calculate the results. We started learning about what and how the various activation functions are used and the broad classification of supervised and unsupervised learning. Even though our usage was different types of CNN and RPN, in order to understand their complex networks, we had to start from the simplest of networks and understand from the most basic of perceptron. After the studies we attempted to undertake the task of understanding the CNNs and the RPN. 
 
2.2 Learning about TensorFlow 
TensorFlow is an open source software library for high performance numerical computation. Its flexible architecture allows easy deployment of computation across a variety of platforms (CPUs, GPUs, TPUs), and from desktops to clusters of servers to mobile and edge devices. Originally developed by researchers and engineers from the Google Brain team within Google’s AI organization, it comes with strong support for machine learning and deep learning and the flexible numerical computation core is used across many other scientific domains.  
TensorFlow is one of the major libraries through which the neural networks can be implemented. For us, TensorFlow will serve as the main python language library on which the whole project will be made. Hence a thorough knowledge of python and TensorFlow is necessary in order to implement our project successfully. We tried to use all the various resources available to us to learn and gather as much knowledge as possible to learn. 
 
2.3 Learning about the various Datasets and their Biological Significance 
We are working on a project which focuses on the early detection of four classes of Malaria Parasite (Plasmodium) and in order to actually implement the project efficiently, we require basic knowledge about the Blood cells, Plasmodium and its four types, its effect on human body and ways to treat this deadly disease. The project aims to target to help the overall patients and doctors alike by reducing and simplifying the task of accurately identifying the patients suffering from malaria so that their treatment can be started at very early stages which will result in high percentage of successful results and will significantly reduce the number of deaths. 
 
2.4 Research Papers 
To gain a basic understanding and to draw our bases we referred to research papers which gave very valuable insights into the implementation of such neural network’s projects. Each research paper carried with it a plethora of experienced insights and veteran ways of implementing a project of such magnitude. Through each paper referred (listed in references) we added a lot to our knowledge and hope to utilise the knowledge in making our project even better.  



DETAILED DESIGN 
 
4.1 Data Pre-processing 
We created our own separate dataset by collecting publicly available images of healthy white blood cells and blood cell smears containing malarial parasites. Further we went on to augment these images so that our training can be more comprehensive and the results can be more precise. In order to keep our research and project as efficient and potent as possible, we had undertaken a multi-level dataset creation. Initially we had collected and labelled approximately 12,500 images containing various healthy blood cell images. . Then these images were labelled one by one using the software LabelImg. On top of that we had collected, created and labelled various blood cell smears covering effectively all the categories and subcategories of malarial plasmodium. Our final level was integrating both of the datasets into one final dataset containing approximately 500 images which were divided randomly into testing and training sets to prevent overfitting of our network. This number was arrived at after various network trainings and was decided upon the accuracy with which the images were being detected. The labels have been stored in .XML files which were converted to CSV file in the training process.    
To further avoid overfitting of our model to our specific dataset, the augmented images contain intentionally added noises and transformation (Rotational). Each such picture not only serves as a new input image but also improves the overall versatility of our model. 
 
 
4.2 Model 
While studying about and implementing our initial approach we came across different methods which we think can improve the computational time and accuracy. 
The first approach consists of 3 major levels. At the very first level our data has to pass through the simultaneous yet independent CNN and RNN layers. The output from this layer is passed as input to the Merge layer which serves as our level 2. At the final layer, SoftMax layer is applied which gives the probability distribution which allows us to classify the blood samples and obtain the respective results. 
The Second approach is using TensorFlow Object Detection API which is officially provided by Google. We used modified Google’s Inception v2 in the form of faster RCNN network.    

4.2.1 CNN 
Firstly, the weights from the pre-training on the ImageNet dataset are used as the initialization weights of the CNN model. Then we add the convolutional layer with a window size which is generally 3 x 3 or 5 x 5.  
The image data matrix is multiplied with the weights and we obtain a new matrix. Then a polling layer is added with commonly used sliding window of 2 x 2 and sliding step of 2. The main aim of this layer is to reduce the number of parameters which are not necessary for our model. As our data goes through this layer, we will get almost half of the parameter which reduces a lot of computation and decreases the time for the training of this model. 
Each convolutional layer creates abstractions based on the previous information. The first layers usually learn edges, the second finds patterns in edges in order to activate for more complex shapes and so forth. Eventually we end up with a convolutional feature map which has spatial dimensions much smaller than the original image, but greater depth. The width and height of the feature map decrease because of the pooling applied between convolutional layers and the depth increases based on the number of filters the convolutional layer learns. In its depth, the convolutional feature map has encoded all the information for the image while maintaining the location of the things it has encoded relative to the original image. 
 
4.2.2 RPN 
RPN takes all the reference boxes (anchors) and outputs a set of good proposals for objects. It does this by having two different outputs for each of the anchors. The first one is the probability (Objectness Score) that an anchor is an object. Note that the RPN doesn’t care what class of object it is, only that it does in fact look like an object and not background. We are going to use this objectness score to filter out the bad predictions for the second stage. The second output is the bounding box regression for adjusting the anchors to better fit the object it’s predicting. 
The RPN is implemented efficiently in a fully convolutional way, using the convolutional feature map returned by the base network as an input. First, we use a convolutional layer with 512 channels and 3x3 kernel size and then we have two parallel convolutional layers using a 1x11x1 kernel. 
For the classification layer, we output two predictions per anchor: the score of it being background (not an object) and the score of it being foreground (an actual object). For the regression, or bounding box adjustment layer, we output 4 predictions which we will apply to the anchors to get the final proposals. Using the final proposal coordinates and their objectness score we then have a good set of proposals for object 

4.2.3 Region of Interest Pooling 
After the RPN step, we have a bunch of object proposals with no class assigned to them. Our next problem to solve is how to take these bounding boxes and classify them into our desired categories. 
Our model tries to solve this problem by reusing the existing convolutional feature map. This is done by extracting fixed-sized feature maps for each proposal using region of interest pooling. Fixed size feature maps are needed for the R-CNN in order to classify them into a fixed number of classes. 
 
 
 
IMPLEMENTATION 
 
After installing all the required softwares like Anaconda Navigator, TensorFlow, Python 3.6 and its libraries we moved on to collect images and create our dataset. 
Our first dataset had 12,478 augmented images of blood cells (JPEG), with 9,987 and 2,491 training and test images, respectively. These images were those of the healthy white blood cells which signify that the patient currently isn’t suffering from a major disease. Our second dataset had 2,275 images of malaria infected blood cell smears. These images had all the categories of the malarial plasmodium, which are plasmodium falciparum, plasmodium knowlesi, plasmodium malariae, plasmodium ovale and plasmodium vivax. We had then made a combined dataset which was derived from these two datasets. It contained approximately 500 images and this number was arrived at after training and testing our networks on these datasets many times.  
 
In order to do the above training, we had to first create a virtual environment in which our python will run. After the creation of the environment, we went on to install TensorFlow followed by the various different libraries which we required to complete our project. These included, but were not limited to, pillow, lxml, cython, jupyter, matplotlib, pandas, OpenCV-python. In order to run the python in our environment we had to define the PYTHONPATH variable and incorporate it with our operating system’s PATH variable.  
After the initial configurations, we went on ahead to create our label map which would serve as the guiding path to our network in detecting the various objects. Label map contains a list of the various classes our model can/needs to detect in a predefined syntax. For TensorFlow to train on what the objects are we had to label each picture showing where the objects are located. As mentioned before, this was done using a software LabelImg which is a great open source image labelling tool which converts the objects in these pictures to an XML file. These XML files contain the boundaries of the objects in the image. Now in order to create TensorFlow records we need to convert these XML files into a CSV file using python scripts. 
After labelling these images we activated our virtual environment using command prompt. Then this CSV file is imported using command prompt and we had trained our network many times on 2 different laptops, having NVIDIA 750 and NVIDIA 1050 graphics card respectively. By also incorporating the 750 series graphics card, it provided us with a holistic approach by covering how the network training and implementation would work when run on a low powered laptop (hardware wise). The 1050 graphics card was our opus magnum and was the main hardware which completed and tested our work. Any neural network’s training process requires a lot of computational power hence it takes several hours to train our model. We had completed various training sessions on both these laptops ranging from 1 hour 35 minutes to 21 hours. These practices assured us that our project was on the right path and gave us the insights required to tweak our methods and datasets to achieve greater results.      
After the most important and computationally expensive training process ends, we ran our test images. These images were passed through our model and we received the outputs which contained bounding boxes around the objects which contained the probability of that particular image belonging to the respective class. This testing was possible by freezing the weights of our network after training and this was done by extracting the inference graph. Inference graph is basically just a collection of all the weights of each node in our network. The outputs were generated with the help of Softmax Layer. This SoftMax is nothing but a probability Distribution which tells us about the probability that this image belongs to this class. 



CONCLUSION 

Faster R-CNN is one of the models that proved that it is possible to solve complex deep learning problems with the same principles that showed such amazing results at the start of this new deep learning revolution. 
New models are currently being built, not only for object detection, but for various other technical fields, that are based on this original model. Some borrow the RPN, some borrow the R-CNN, others just build on top of both. This is why it is important to fully understand what this model is actually doing so we are better prepared to tackle future problems. 
This project uses Convolutional Neural Network to identify the images of the blood cell of the patients who are suffering from Malaria. These images contain four different type of Malaria Parasite as mentioned above. By just looking at the image this model can automatically detect the malaria parasite and output the bounding box across the plasmodium parasite which can be really helpful in early detection of Malaria. The time taken by the doctors for analysing the sample can be cut down and the treatment process can be started immediately which can save the life of such people who lose this fight by fractions of second. 
Finally we tested this model on some random images from Google and this model was pretty accurate in separating the images which contain Malaria Parasite from the healthier ones. Then we made a video of various images of blood cell collected by the blood samples from the patients suffering from malaria and as soon as the video is given as the input to this model it clearly creates bounding boxes across all the Malaria parasites as the video progresses. It was able to identify all four different types of parasite and nearly all the parasites were detected by the model in the input video. 
 
 
 
FUTURE SCOPE 

Even though we accomplished our aims with which we had set out to complete our Minor, along the journey of working on this topic and gaining lots of new knowledge, we have arrived at the conclusion that our project plays a pivotal role in the rising trend of combining engineering and medical fields together. Further serving our goal to empower the financially low funded hospitals, our project can be worked upon to run on different neural networks like the MobileSSD networks which can be run on smaller devices like a RasberryPi, mobiles, etc.  
Furthermore, our project work successfully lays down path for future incorporation of other pathogens which will provide today’s doctors more efficient and time saving methods to diagnose the various lifethreatening diseases like anaemia, dengue, etc. Which are caused by different pathogens. Another future application of our model can be the detection of those diseases like Leukaemia, leishmania, DIC (Disseminated Intravascular Coagulation), Filariasis, etc in which the coagulation of blood cells takes place. 
 Our model can be further configured to provide a count of the various kinds of cells and parasites detected in the given sample image. This will, in turn, speed up the diagnosis process even further. We can also tweak our project to create a more user-friendly UI making it easy to use for everyone and making the facilities more accessible for everyone.  

